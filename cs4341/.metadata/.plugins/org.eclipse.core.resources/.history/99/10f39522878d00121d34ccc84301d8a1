/**
 *  @author Mike Della Donna
 */
package project0;

import java.util.List;

import land.Cell;
import land.Land;
import land.Point;

import org.eclipse.swt.SWT;
import org.eclipse.swt.events.PaintEvent;
import org.eclipse.swt.events.PaintListener;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;

import search.DepthFirstSearch;
import search.SearchStrategy;

public class MainDemoGUI {

	/**
	 * Launch the application.
	 * @param args
	 */
	public static void main(String[] args) {
		
		Cell[] row4 = {new Cell(true,true,false,true,0,0,"rock",new Point(4,0)),
				new Cell(false, false, false, true, 0, 0, null, new Point(4,1)),
				new Cell(false, false, false, true, 0, 0, null, new Point(4,2)),
				new Cell(false, false, false, true, 0, 0, null, new Point(4,3)),
				new Cell(false, false, false, true, 0, 0, null, new Point(4,4))};

		Cell[] row3 = {new Cell(false,false,false,true,0,0,null,new Point(3,0)),
				new Cell(true, true, false, true, 0, 0, "rock", new Point(3,1)),
				new Cell(false,false,false,true,4,10,null, new Point(3,2)),
				new Cell(false,false,false,true,2,10,null, new Point(3,3)),
				new Cell(false, false, false, true, 0, 0, null, new Point(3,4))};

		Cell[] row2 = {new Cell(false, false, false, true, 0, 0, null, new Point(2,0)),
				new Cell(false, false, false, true, 4, 10, null, new Point(2,1)),
				new Cell(false, false, false, true, 6, 10, null, new Point(2,2)),
				new Cell(false, false, false, true, 4, 10, null, new Point(2,3)),
				new Cell(false, false, false, true, 0, 0, null, new Point(2,4))};

		Cell[] row1 = {new Cell(false, false, false, true, 0, 0, null, new Point(1,0)),
				new Cell(false, false, false, true, 2, 10, null, new Point(1,1)),
				new Cell(false, false, false, true, 4, 10, null, new Point(1,2)),
				new Cell(true,  true,  false, true, 0, 0,"rock",new Point(1,3)),
				new Cell(false, false, false, true, 0, 0, null, new Point(1,4))};

		Cell[] row0 = {new Cell(false, false, false, true, 0, 0, null,new Point(0,0)),
				new Cell(false, false, false, true, 0, 0, null, new Point(0,1)),
				new Cell(false, false, false, true, 0, 0, null, new Point(0,2)),
				new Cell(false, false, false, true, 0, 0, null, new Point(0,3)),
				new Cell(true,true,false,true,0,0,"rock", new Point(0,4))};

		Cell[][] grid = {row0, row1, row2, row3, row4};
		
		Land land = new Land(5,5);
		
		land.populateLand(grid);
		
		//pick your srteategy
		//SearchStrategy search = new DepthFirstSearch();
		SearchStrategy search = new BreadthFirstSearch();
		//SearchStrategy search = new UniformCostSearch();
		
		final List<Cell> path = land.search(new Point(0,0), new Point(4,4),search);
		final List<Cell> list = land.getCells();
		
		final Display display = Display.getDefault();
		final Shell shell = new Shell(display);
		shell.setBackground(display.getSystemColor(SWT.COLOR_WHITE));
		
		shell.addPaintListener(new PaintListener(){ 
	        public void paintControl(PaintEvent e){  
	            
	            Point lastPoint = path.get(0).location;
	            e.gc.setBackground(display.getSystemColor(SWT.COLOR_WHITE));
	            for(Cell cell : list)
	            {
	            	e.gc.setForeground(display.getSystemColor(SWT.COLOR_BLACK));
	            	
	            	if(!cell.obstacle){
	            		e.gc.drawRectangle((cell.location.x * 100), (cell.location.y * 100), 100, 100);}
	            	else{
	            		e.gc.setBackground(display.getSystemColor(SWT.COLOR_BLACK));
	            		e.gc.fillRectangle((cell.location.x * 100), (cell.location.y * 100), 100, 100);}
	            	e.gc.setBackground(display.getSystemColor(SWT.COLOR_WHITE));
	            	
	            	e.gc.drawText(cell.location.x+" "+cell.location.y,(cell.location.x * 100) + 10, (cell.location.y * 100)+5); 
	            	e.gc.drawText("cost="+cell.cost,(cell.location.x * 100) + 10, (cell.location.y * 100)+20);
	            	e.gc.drawText("elevation="+cell.elevation,(cell.location.x * 100) + 10, (cell.location.y * 100)+35);
	            	
	            }
	            
	            for(Cell cell : path)
	            {
	            	e.gc.setForeground(display.getSystemColor(SWT.COLOR_BLUE));
		            e.gc.drawLine((cell.location.x * 100) + 50,(cell.location.y * 100) + 50,(lastPoint.x * 100) + 50,(lastPoint.y * 100) + 50);
		            lastPoint = cell.location;
	            }
	        } 
	    });
		shell.setSize(600, 600);
		shell.setText("Graphical Path Representation");
		
		

		shell.open();
		shell.layout();
		while (!shell.isDisposed()) {
			if (!display.readAndDispatch()) {
				display.sleep();
			}
		}
	}

}
